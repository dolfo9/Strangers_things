(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{28:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n(5),c=n(1),a=n(20),o=n.n(a),i=n(10),u=n(2),j=(n(28),n(4)),p=n.n(j),h=n(9),l=function(e){var t=e.type,n=e.setToken,a=e.setUser,o=Object(c.useState)(""),u=Object(r.a)(o,2),j=u[0],l=u[1],b=Object(c.useState)(""),d=Object(r.a)(b,2),O=d[0],x=d[1],f="login"===t?"Login":"Register",g="login"===t?"Register":"Login",m="login"===t?"register":"login",v=function(){var e=Object(h.a)(p.a.mark((function e(s){var r,c,o,i,u,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:j,password:O}})});case 3:return r=e.sent,e.next=6,r.json();case 6:if(c=e.sent,o=c.data,!(i=null===o||void 0===o?void 0:o.token)){e.next=19;break}return n(i),e.next=13,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(i)}});case 13:return u=e.sent,e.next=16,u.json();case 16:h=e.sent,b=h.data,a(b);case 19:l(""),x("");case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h2",{children:f}),Object(s.jsxs)("form",{onSubmit:v,children:[Object(s.jsx)("input",{type:"text",value:j,onChange:function(e){return l(e.target.value)},placeholder:"username"}),Object(s.jsx)("input",{type:"password",value:O,onChange:function(e){return x(e.target.value)},placeholder:"password"}),Object(s.jsx)("button",{type:"submit",children:f})]}),Object(s.jsx)(i.b,{to:"/".concat(m),children:g})]})},b=function(e){var t=e.id,n=e.fetchPosts,r=e.token;if(r){var c=function(){var e=Object(h.a)(p.a.mark((function e(){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(t),{method:"DELETE",headers:{"Content-type":"application/json",Authorization:"Bearer "+r}});case 2:s=e.sent,console.log(s),n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsx)("button",{onClick:c,children:"Delete"})}},d=n(22),O=function(e){var t=e.token,n=e.post,a=e.setPost,o=Object(c.useState)(""),i=Object(r.a)(o,2),u=i[0],j=i[1],l=Object(c.useState)(""),b=Object(r.a)(l,2),O=b[0],x=b[1],f=Object(c.useState)(""),g=Object(r.a)(f,2),m=g[0],v=g[1],k=function(){var e=Object(h.a)(p.a.mark((function e(s){var r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{method:"POST",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:u,description:O,price:m}})});case 3:return r=e.sent,e.next=6,r.json();case 6:c=e.sent,o=c.data,a([o.post].concat(Object(d.a)(n))),j(""),x(""),v("");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h2",{children:"Add Post"}),Object(s.jsxs)("form",{onSubmit:k,children:[Object(s.jsx)("input",{type:"text",value:u,placeholder:"title",onChange:function(e){j(e.target.value)}}),Object(s.jsx)("input",{type:"text",value:O,placeholder:"description",onChange:function(e){x(e.target.value)}}),Object(s.jsx)("input",{type:"text",value:m,placeholder:"price",onChange:function(e){v(e.target.value)}}),Object(s.jsx)("button",{children:"Submit Post"})]})]})},x=function(e){var t=e.token,n=e.id,a=Object(c.useState)(""),o=Object(r.a)(a,2),i=o[0],u=o[1],j=function(){var e=Object(h.a)(p.a.mark((function e(s){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(n,"/messages"),{method:"POST",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({message:{content:i}})});case 3:r=e.sent,console.log("message",r),u("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("form",{onSubmit:j,children:[Object(s.jsx)("input",{type:"text",value:i,onChange:function(e){u(e.target.value)}}),Object(s.jsx)("button",{children:"Send"})]})},f=function(e){var t=e.token,n=Object(c.useState)([]),a=Object(r.a)(n,2),o=a[0],i=a[1],u=function(){var e=Object(h.a)(p.a.mark((function e(){var n,s,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+t}});case 2:return n=e.sent,e.next=5,n.json();case 5:s=e.sent,r=s.data,i(r.posts);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)(Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u();case 1:case"end":return e.stop()}}),e)}))),[]),Object(s.jsxs)(s.Fragment,{children:[t?Object(s.jsx)(O,{token:t,post:o,setPost:i}):"",Object(s.jsxs)("div",{className:"postList",children:[Object(s.jsx)("h2",{children:"Posts"}),o.map((function(e){return Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:e.title}),Object(s.jsxs)("p",{children:["From: ",e.author.username]}),Object(s.jsx)("p",{children:e.price}),e.isAuthor?Object(s.jsx)(b,{fetchPosts:u,id:e._id,token:t}):"",!e.isAuthor&&t?Object(s.jsx)(x,{id:e._id,token:t}):""]},e._id)}))]})]})},g=function(e){var t=e.user;console.log(t);var n=t.messages&&t.messages.length>0;return Object(s.jsxs)("div",{className:"profile",children:[Object(s.jsx)("h3",{children:"Profile"}),Object(s.jsx)("h5",{children:"Messages"})," ",n?t.messages.map((function(e){return Object(s.jsxs)("div",{className:"message",children:[Object(s.jsx)("h6",{children:e.post.title}),Object(s.jsxs)("p",{children:["Message: ",e.content]}),Object(s.jsxs)("p",{children:["From: ",e.fromUser.username]})]})})):""]})},m=function(){var e=Object(c.useState)(localStorage.getItem("token")||""),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)({}),j=Object(r.a)(o,2),p=j[0],h=j[1];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Strangers Things"}),p.username&&Object(s.jsxs)("div",{children:["Hello ",p.username,Object(s.jsx)("button",{onClick:function(){h({}),a(""),localStorage.removeItem("token")},children:"Logout"})]}),Object(s.jsx)(i.b,{to:"/login",children:"Login"}),Object(s.jsx)(i.b,{to:"/posts",children:"Post"}),n?Object(s.jsx)(i.b,{to:"/profile",children:"Profile"}):"",Object(s.jsx)(u.a,{path:"/login",children:Object(s.jsx)(l,{type:"login",setToken:a,setUser:h})}),Object(s.jsx)(u.a,{path:"/register",children:Object(s.jsx)(l,{type:"register",setToken:a,setUser:h})}),Object(s.jsx)(u.a,{path:"/posts",children:Object(s.jsx)(f,{token:n})}),Object(s.jsx)(u.a,{path:"/profile",children:Object(s.jsx)(g,{user:p})})]})};o.a.render(Object(s.jsx)(i.a,{children:Object(s.jsx)(m,{})}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.70ea7090.chunk.js.map